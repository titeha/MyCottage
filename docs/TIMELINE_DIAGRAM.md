# Диаграмма сезона: посадки → рост → созревание → сбор (Timeline/Gantt)

## 1) Цель
Дать пользователю **наглядную временную картину сезона**:
- когда и что посажено/посеяно;
- сколько длится период роста/созревания;
- когда ожидается “окно сбора” (первый сбор → окончание);
- как пересекаются культуры по времени (нагрузка на дачника, пики работ).

Диаграмма должна работать:
- на Android (телефон + планшет) с горизонтальной прокруткой;
- на Web Portal (большой экран, фильтры, группировка).

## 2) Источники данных
Диаграмма строится из доменных сущностей (ядро + расчёты):

1) Planting
- planted_at (дата посева/высадки)
- planting_method (SEEDS/SEEDLING/SAPLING/…)
- crop_id, variety_id (если есть)

2) CropReference / Variety
- maturity_days_min / maturity_days_max (ориентировочно)
- (позже) фазы/tech card: этапы выращивания

3) Климат/погода (ядро)
- AgroClimateProfile (длина сезона, риск заморозков)
- WeatherDaily/Forecast (для подсказок и переносов задач)

4) Task
- задачи и “окна” (HarvestWindow, GrowthWindow, обработки и т.п.)
- источник: SYSTEM/USER/AI_PROPOSAL

Примечание: на MVP допускается строить диаграмму только из planted_at + maturity_days (без техкарт).

## 3) Модель представления (что рисуем)
Каждая строка = “объект диаграммы” (по умолчанию — посадка).

Минимальные сегменты (MVP):
- Growth: [planted_at … harvest_window_start]
- HarvestWindow: [harvest_window_start … harvest_window_end] (диапазон)
- Optional marker: “проверить всходы/приживаемость” (точка)

Расчёт “HarvestWindow” на MVP:
- harvest_start = planted_at + maturity_days_min
- harvest_end = planted_at + maturity_days_max

Позже (после техкарт):
- дополнительные сегменты: пикировка/высадка/подкормки/обрезка/укрытие/обработки
- сегменты могут формироваться из техкарты + корректироваться по погоде.

## 4) UX: Android

### 4.1 Точка входа
- вкладка/экран “Календарь” → переключатель “Календарь / Диаграмма”
или
- отдельная вкладка “Диаграмма” (если календарь перегружен)

### 4.2 Визуальная модель
- слева: список строк (культура/сорт/зона)
- справа: шкала времени (дни/недели/месяцы) + сегменты
- вертикальная прокрутка по строкам
- горизонтальная прокрутка по времени
- “Сегодня” — вертикальная линия

### 4.3 Управление
- zoom уровни (упрощённо):
  - Неделя
  - Месяц
  - Сезон
- фильтры:
  - участок, зона
  - культура (и/или семейство)
  - статус (ACTIVE/HARVESTED)
- тап по сегменту → карточка посадки / список задач по посадке

### 4.4 Планшеты
- multi‑pane: слева фильтры/список, справа диаграмма
- drag&drop не обязателен для диаграммы (достаточно фильтров и масштаба)

## 5) UX: Web Portal
- отдельная страница “Season Timeline”
- фильтры и группировка:
  - по зонам (грядки/теплица/сад)
  - по культурам
- экспорт:
  - “сохранить картинку” (PNG) или печать (PDF) — опционально

## 6) Нефункциональные требования
- Производительность: диаграмма должна оставаться отзывчивой при 200–500 посадках на участок.
- Офлайн‑first: мобильная диаграмма строится из локальных данных (без сети).
- Объяснимость: сегменты должны иметь подсказку “почему такой диапазон” (ссылка на maturity_days/variety/климатический профиль).

## 7) Связь с правилами/ИИ
Диаграмма не только “рисует”, но и служит UI для понимания рекомендаций:
- если AI/правила создали TaskProposal (обработка яблонь против вредителя),
  на диаграмме появляется сегмент/окно “обработка” (после подтверждения пользователем).
