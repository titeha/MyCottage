# Техническое задание: “Моя дача” (Mobile + Web + Cloud)

Версия: 0.5  
Дата: 2026-02-22

Документ фиксирует **ядро** (то, что делаем сразу) и **план расширений**.  
Ключевой принцип: **офлайн‑first** на мобильных клиентах и **API‑first** для будущих iOS/Web.

---

## 0. Область и цели

### 0.1 Платформы
- Android (телефон + планшет) — старт.
- iOS — позже, архитектура закладывается заранее (контракты и общий доменный слой).
- Web — портал: сообщество + инструменты (план участка и “компьютерные” операции).

### 0.2 Цели ядра
- Быстро вести дневник посадок и работ.
- Видеть “что где растёт” на плане участка.
- Получать календарь событий и напоминания.
- Учитывать климат/сезонность РФ: безморозный период, заморозки, осадки (с офлайн‑fallback).
- Давать базовый прогноз “когда собирать” (ориентировочно) без тяжёлой агрономии.

---

## 1. Термины
- Site (Участок) — профиль дачи/локации.
- Zone (Зона) — часть участка: грядка, теплица, садовый ряд, клумба и т.п.
- Planting (Посадка/растение) — культура/сорт + дата + зона + параметры.
- Task (Задача/событие) — действие/напоминание (посев, сбор, полив, обрезка…).
- JournalEntry — запись дневника (текст/фото, теги).
- PlotPlan — план участка (схема), PlotFeature — геометрия зон/объектов, PlantPlacement — размещение посадок на схеме.
- AgroClimateProfile — характеристики сезона на основе истории погоды (если доступно).
- Tech card (Техкарта) — шаблон выращивания культуры (уход/операции).
- Observation — результат распознавания (вредитель/болезнь/дефицит/идентификация).
- TaskProposal — предложение задачи (создаётся правилами/ИИ, требует подтверждения).

---

## 2. Ядро (обязательные функциональные требования)

### FR-01 Участки и зоны
Функции:
- создание участка (Site): название, регион/город (текст), координаты (опционально), зона зимостойкости (опционально);
- создание зон (Zone): тип (грядка/теплица/сад/цветник/контейнер), название, освещённость (опц), заметка.

Acceptance:
- можно иметь несколько участков (опционально включаем в MVP).
- зоны фильтруются и отображаются в планировщике.

### FR-02 Посадки (Plantings)
Режимы:
- быстрый: культура + дата + зона;
- расширенный: культура + сорт(текст) + способ посадки + количество + фото + заметки.

Acceptance:
- добавление посадки ≤ 30 секунд (на телефоне).
- посадки фильтруются по зоне/культуре/активности.

### FR-03 Журнал работ
- запись: текст + фото + теги (полив, подкормка, обработка, обрезка, сбор…)
- привязка к посадке/зоне

Acceptance:
- журнал доступен офлайн.
- запись можно быстро создать из карточки посадки.

### FR-04 Календарь и задачи
- автогенерация базовых задач по культуре:
  - “проверить всходы/приживаемость” через X дней
  - “окно урожая/первый сбор” через N дней (диапазон)
- пользовательские задачи
- статусы: planned/done/skipped
- локальные уведомления



Подфункция (R1.2): **Диаграмма сезона (Timeline/Gantt)**
- наглядный режим, который показывает по каждой посадке:
  - окно роста,
  - окно сбора (диапазон),
  - ключевые точки/задачи;
- горизонтальная прокрутка по времени (телефон) + multi‑pane на планшетах;
- фильтры по участку/зоне/культуре.
Acceptance:
- задачи создаются при добавлении посадки и видны в календаре.
- уведомления настраиваются (время, включить/выключить).

### FR-05 Климат/погода/агроклимат (в ядре)
Требование: ядро обязано учитывать сезонность РФ, при этом сохранять офлайн‑работоспособность.

Минимум:
- координаты участка (если есть) → загрузка прогноза (7–10 дней) и кэш daily;
- алерт заморозков (по tmin);
- сумма осадков за 7 дней → подсказка “полив/не полив”.

Офлайн‑fallback:
- если интернета нет: используем регион + консервативные окна сезона, показываем “нет данных прогноза”.

Acceptance:
- пользователь может выключить погодные уведомления.
- при наличии данных: заморозок/осадки отражаются в ленте “Главная”.

### FR-06 План участка с посадками (Plot Planner v1)
Функции:
- создать план участка;
- добавить геометрию зон (простые формы) и связать с Zone;
- разместить посадки на плане (точка/группа);
- переход: тап по зоне/посадке → карточка.

Acceptance:
- план работает офлайн.
- на планшете поддерживается зум/панорамирование и (опционально) drag&drop.

---

## 3. Расширения (поэтапно)

### FR-07 Техкарты выращивания культур (доп.)
- для культуры/сорта выдавать “карту работ” по сезонам/фазам;
- генерация задач (полив/подкормки/пасынкование/укрытие и т.п.);
- корректировка по погоде (перенос/предупреждения).

### FR-08 Справочник сортов (доп.)
- карточки сортов: сроки, назначение, условия (ОГ/теплица), примечания;
- привязка к расчётам сроков (maturity_days);
- источники: официальный реестр/производители/сообщество (с пометкой источника).

### FR-09 Почвы и плодородие (доп.)
- профиль почвы (тип/дренаж/pH), почвенная карта (опционально), лабораторные анализы;
- “план восстановления плодородия” (протоколы + задачи);
- севооборот на основе истории посадок.

### FR-10 Справочник СЗР/удобрений/стимуляторов (доп.)
- справочник “разрешённых” (по официальному каталогу/реестру);
- фильтры: культура, вредный объект, действующее вещество, класс;
- safety‑политика:
  - не генерировать смеси,
  - не давать дозировки “из головы”,
  - показывать ссылку на официальную инструкцию/регламент.

### FR-11 AI‑чат помощник (доп.)
- чат с контекстом дневника;
- ответ структурированно: план действий + что проверить + риски;
- предложения задач (TaskProposals), которые пользователь подтверждает.

### FR-12 AI‑наблюдения → задачи (доп., ключевая)
Сценарий:
- фото → распознали вредителя/болезнь → создали Observation → создали Issue → предложили задачи (осмотр/меры/опц. обработка по инструкции).

Принцип:
- “обработка” только после подтверждения и выбора препарата из справочника.

### FR-13 Обрезка по фото/видео (доп.)
- мастер‑режим (культура/сезон/цель + фото) → инструкция;
- позже: подсветка зон на фото.

### FR-14 Болезни/вредители по фото (доп.)
- triage: гипотезы + вопросы + безопасные шаги;
- предложения задач.

### FR-15 Заготовки/рецепты (доп.)
- при сборе урожая предлагать рецепты/заготовки;
- список покупок и задачи.

### FR-16 Автоматизация (позже)
- интеграция Home Assistant/MQTT;
- сценарии: задачи/погода → действия (полив).

### FR-17 Веб‑портал (позже)
- форум/соцсеть (движок) + SSO;
- web‑план участка (удобный редактор);
- массовые операции и аналитика.

---

## 4. Нефункциональные требования

### NFR-01 Офлайн‑first
- дневник/план/календарь/журнал работают без интернета.
- при появлении сети — синхронизация.

### NFR-02 Приватность
- фото и данные пользователя — чувствительные.
- отправка в AI/облако только по согласию.
- “удалить все данные” — обязателен.

### NFR-03 Безопасность
- OIDC/JWT, HTTPS, роли.
- секреты (автоматизация) — шифровать.

### NFR-04 Объяснимость и ответственность
- AI и рекомендации должны показывать:
  - уверенность,
  - источники (внутренние карточки/официальные ссылки),
  - предупреждения.

---

## 5. Документы‑приложения (в репозитории)
- ARCHITECTURE.md — архитектура
- DATA_MODEL.md — модель данных
- API_SPEC.md — API черновик
- WEATHER_AGROCLIMATE.md — климат/погода
- SOIL_MODULE.md — почвы/плодородие
- PLOT_PLANNER.md — план участка
- TIMELINE_DIAGRAM.md — диаграмма сезона
- CHEMISTRY_REFERENCE.md — СЗР/удобрения
- RULES_ENGINE.md — Observation → Tasks
- VARIETIES.md — сорта
- WEB_PORTAL.md — веб‑портал
- RECIPES_PRESERVING.md — заготовки
- AUTOMATION.md — автоматизация

